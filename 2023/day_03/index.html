<!doctype html>
<html lang="en">

<head>
<meta charset="utf-8">
<title>Day 3 | 2023</title>

<style>

#container .visualization {
  font-family: monospace;
  /* Yields a table that is ~1200px wide with the full input */
  font-size: 8px;
}

.visualization td {
  background-color: white;
  transition: background-color 200ms;
}

.visualization td.cursor {
  background-color: lightskyblue;
  transition: background-color 10ms;
}


</style>

</head>



<body>

<!--

Part 1
-------
The full input is approximately 140x140 characters.
Can I display it semi-reasonably all at once?
Using 8px font size, the full input makes a table that is ~1200px.

Algorithm:
- scan grid until find a digit
- scan forward to identify all digits in number
  - enqueue bordering cells to check
    - if cell is non-period, non-digit
      - parse digits
      - add to sum


Feels like a good candidate for simple animation (finally?),
but it won't be _quick_ to iterate over ~20k cells (that's okay).

Animations
- "base" cells
  - default 1 cell as scanning, grows to the right when find digits
- bordering cells
- "found symbol"
- update sum



Part 2
-------

-->

<div id="container">
  <h1>Day 3</h1>
  <div class="controls">

    <!-- Data source select -->
    <div class="control-group">
      <label for="data-source-sample">
        <input
          checked
          id="data-source-sample"
          name="data-source"
          type="radio"
          value="sample"
        />
        Sample
      </label>
      <label for="data-source-full">
        <input
          id="data-source-full"
          name="data-source"
          type="radio"
          value="full"
        />
        Full
      </label>
    </div>

    <button class="solve">Solve</button>
  </div>

  <h2 id="answer-part1">Sum:</h2>
  <h2 id="answer-part2"></h2>

  <table class="visualization"><tbody></tbody></table>

</div>


<script src="data.js" type="text/javascript"></script>
<script src="sample.js" type="text/javascript"></script>


<script type="text/javascript">

async function sleep(ms) {
  return new Promise(resolve => setTimeout(resolve, ms));
}

function reset() {
  document.querySelector('#answer-part1').replaceChildren();
  document.querySelector('#answer-part1').textContent = 'Sum:'
  document.querySelector('#answer-part2').replaceChildren();
  document.querySelector('.visualization tbody').replaceChildren();
}


function populateTable(data) {
  let r = 0;
  let c = 0;
  for (const line of data) {
    const row = document.createElement('tr');
    c = 0;
    for (const char of line) {
      const cell = document.createElement('td');
      cell.id = `cell-${r}-${c}`;
      cell.textContent = char;
      row.appendChild(cell);
      c++;
    }
    document.querySelector('.visualization tbody').appendChild(row);
    r++;
  }
}


function isDigit(char) {
  return (48 <= char.charCodeAt(0) && char.charCodeAt(0) <= 57);
}


async function solveWholeDay() {
  const dataSource = document.querySelector('#container [name="data-source"]:checked').value;
  const schematic = dataSource === 'sample'
    ? getSampleData()
    : getFullData();
  populateTable(schematic);

  for (let r = 0; r < schematic.length; r++) {
    for (let c = 0; c < schematic[r].length; c++) {
      const cell = document.getElementById(`cell-${r}-${c}`)
      cell.classList.add('cursor');
      await sleep(100);
      if (!isDigit(cell.textContent)) {
        cell.classList.remove('cursor');
      }
    }
  }
}


document.addEventListener('DOMContentLoaded', (event) => {
  document.querySelector('#container .solve').addEventListener('click', () => {
    reset();
    solveWholeDay();
  });
});

</script>

</body>

</html>

