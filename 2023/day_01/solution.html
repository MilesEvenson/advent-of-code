<!doctype html>
<html lang="en">

<head>
<meta charset="utf-8">
<title>Day 1</title>

<style>

#part1 > .solution {
  display: flex;
  font-family: monospace;
  font-size: 16px;
}

#part1 > .solution > .input-lines {
  list-style-type: none;
  padding-left: 0;
  width: 32em;
}
#part1 > .solution > .input-lines .number {
  font-weight: bold;
}

#part1 > .solution > .parsed-numbers {
  list-style-type: none;
  padding-left: 0;
  text-align: right;
  width: 8em;
}

#part1 > .solution > .running-sum {
  margin-left: 4em;
  text-align: right;
}


</style>

</head>

<body>

<!--

Part 1
-------
The full input is 1000 lines long.
I don't think I want the total animation for part 1
to be longer than 10 seconds, so probably no more than 10ms per line.

High level vision:
3 columns
- input lines
- parsed 2-digit integers
- running sum


Animation
- prepend line to column 1, with first 2 digits highlighted
- prepend 2-digit number to colunn 2
- update running sum with new total



-->

<div id="part1">
  <h1>Part 1 - Parse and sum numbers</h1>
  <div class="controls">
    <button class="solve">Solve</button>
  </div>
  <div class="solution">
    <ul class="input-lines"></ul>
    <ul class="parsed-numbers"></ul>
    <p class="running-sum"></p>
  </div>
</div>

<script src="part1.js" type="text/javascript"></script>

<script type="text/javascript">

const part1Sample = [
  '1abc2',
  'pqr3stu8vwx',
  'a1b2c3d4e5f',
  'treb7uchet'
];

async function sleep(ms) {
  return new Promise(resolve => setTimeout(resolve, ms));
}

function clearPart1() {
  document.querySelector('#part1 .input-lines').replaceChildren();
  document.querySelector('#part1 .parsed-numbers').replaceChildren();
  document.querySelector('#part1 .input-lines').replaceChildren();
}

async function solvePart1() {
  const rawDataFull = getDay1Data();
  let sum = 0;
  const queueInput = [];
  const queueDigits = [];

  for (const line of rawDataFull) {
    const digitChars = [];
    const inputLine = document.createElement('li');

    line.split('').forEach(char => {
      const span = document.createElement('span');
      span.textContent = char;
      if (!Number.isNaN(parseInt(char, 10)) && digitChars.length < 2) {
        span.classList.add('number');
        digitChars.push(char);
      }
      inputLine.appendChild(span);
    });

    const lineValue = parseInt(digitChars.join(''), 10);
    const digitLine = document.createElement('li');
    digitLine.textContent = lineValue;

    sum += lineValue;

    queueInput.unshift(inputLine);
    document.querySelector('#part1 .input-lines').prepend(inputLine);

    queueDigits.unshift(digitLine);
    document.querySelector('#part1 .parsed-numbers').prepend(digitLine);

    let inputItemToRemove;
    let digitItemToRemove;
    if (queueInput.length === 11) {
      inputItemToRemove = queueInput.pop();
      document.querySelector('#part1 .input-lines').removeChild(inputItemToRemove);
      digitItemToRemove = queueDigits.pop();
      document.querySelector('#part1 .parsed-numbers').removeChild(digitItemToRemove);
    }

    document.querySelector('#part1 .running-sum').textContent = sum;

    await sleep(10);
  }
}


document.querySelector('#part1 .solve').addEventListener('click', () => {
  clearPart1();
  solvePart1();
});
</script>

</body>

</html>

